function shunt_index = assign_loads_to_buses(ps)
% usage: shunt_index = assign_loads_to_buses(ps)

% prep work
C = psconstants;
n = size(ps.bus,1);
nd = size(ps.shunt,1);

% initiali
shunt_index = nan(n,1);

% assign all of the obvious ones
for d = 1:nd
    % Find the bus that this load serves
    bi = ps.bus_i(ps.shunt(d,1));
    % Assign that bus to this load
    shunt_index(bi) = d;
end

% build the adjacency matrix
nodes = 1:n;
F = ps.bus_i(ps.branch(:,1));
T = ps.bus_i(ps.branch(:,2));
A = sparse([F;T],[T;F],1,n,n);

% Go through each bus that doesn't have a shunt, and give it one

bu_subset = find(isnan(shunt_index));
for i = bu_subset
    i
end
